---
import { getCollection } from 'astro:content';
import MainLayout from '@/layouts/MainLayout.astro';
import Card from '@/components/Card.astro';

const projects = (await getCollection('paper-reviews')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<MainLayout title="Paper Reviews">
  <div class="page-header">
    <h1>Paper Reviews</h1>
  </div>
<!-- Summary Table -->
  <div class="summary-table">
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Title</th>
          <th>Link</th>
          <th>Video</th>
        </tr>
      </thead>
      <tbody>
        {
          projects.map((project) => (
            <tr>
              <td class="date-cell">
                {project.data.date.toLocaleDateString('ko-KR', {
                  year: 'numeric',
                  month: '2-digit',
                  day: '2-digit'
                })}
              </td>
              <td class="title-cell">
                <a href={`/research-portfolio/paper-reviews/${project.slug}`} class="title-link">
                  {project.data.title}
                </a>
              </td>
              <td class="link-cell">
                {project.data.repoLink && (
                  <a href={project.data.repoLink} target="_blank" rel="noopener noreferrer" class="external-link">
                    Link
                  </a>
                )}
              </td>
              <td class="video-cell">
                {project.data.videoLink && (
                  <a href={project.data.videoLink} target="_blank" rel="noopener noreferrer" class="external-link">
                    Video
                  </a>
                )}
              </td>
            </tr>
          ))
        }
      </tbody>
    </table>
  </div>

  <!-- Separator -->
  <div class="content-separator"></div>

  <!-- Original Card View -->
  <div class="cards-section">
    {
      projects.map((project) => (
        <Card
          href={`/research-portfolio/paper-reviews/${project.slug}`}
          title={project.data.title}
          date={project.data.date}
          description={project.data.description}
          meta={project.data.technologies.join(', ')}
        />
      ))
    }
  </div>
</MainLayout>

<style>
  .summary-table {
    margin-bottom: 3rem;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    overflow: hidden;
  }

  th {
    background-color: #f9f9f9;
    padding: 1rem;
    text-align: center;
    font-weight: 600;
    color: var(--color-text);
    border-bottom: 1px solid var(--color-border);
  }

  td {
    padding: 1rem;
    border-bottom: 1px solid var(--color-border);
    vertical-align: top;
  }

  tr:last-child td {
    border-bottom: none;
  }

  tr:hover {
    background-color: var(--color-accent-light);
  }

  .date-cell {
    font-size: 0.9rem;
    color: var(--color-text-muted);
    white-space: nowrap;
    width: 100px;
  }

  .title-cell {
    width: 60%;
  }

  .title-link {
    color: var(--color-text);
    text-decoration: none;
    font-weight: 500;
  }

  .title-link:hover {
    color: var(--color-accent);
    text-decoration: underline;
  }

  .link-cell, .video-cell {
    text-align: center;
    width: 100px;
  }

  .external-link {
    display: block;
    text-align: center;

    color: var(--color-accent);
    height: 100%;
    text-decoration: none;
    font-size: 0.9rem;
    padding: 0.25rem 0.5rem;
    border: 1px solid var(--color-accent);
    border-radius: 4px;
    transition: all 0.2s ease;
  }

  .external-link:hover {
    background-color: var(--color-accent);
    color: white;
    text-decoration: none;
  }

  .content-separator {
    width: 100%;
    height: 1px;
    background-color: var(--color-border);
    margin: 3rem 0;
  }

  .cards-section {
    margin-top: 2rem;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .summary-table {
      overflow-x: auto;
    }

    table {
      min-width: 600px;
    }

    th, td {
      padding: 0.75rem 0.5rem;
    }

    .title-cell {
      width: 40%;
    }
  }
</style>